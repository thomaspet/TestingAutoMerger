<table-search
    *ngIf="config?.searchable"
    [tableConfig]="config"
    [columns]="columns"
    [configFilters]="dataService?.advancedSearchFilters"
    (filtersChange)="onFiltersChange($event)">
</table-search>

<section #wrapper class="uni-ag-wrapper"
    *ngIf="rowModelType"
    [ngStyle]="{'height': tableHeight}">

    <table-editor *ngIf="config?.editable"
        [agGridApi]="agGridApi"
        [config]="config"
        [columns]="columns"
        [rowHeight]="35"
        (valueChange)="onEditorChange($event)">
    </table-editor>

    <ag-grid-angular #agGrid
        [ngClass]="{
            'editable': config?.editable,
            'col-menu-hidden': config && !config.columnMenuVisible
        }"
        [columnDefs]="agColDefs"
        [getRowClass]="rowClassResolver"
        [pinnedBottomRowData]="dataService?.sumRow$ | async"
        [suppressPropertyNamesCheck]="true"

        [rowModelType]="rowModelType"
        [domLayout]="localData ? 'autoHeight' : 'normal'"

        [getRowNodeId]="getRowIdentifier"
        [enableColResize]="true"
        [enableSorting]="!config?.editable && !config?.rowDraggable"
        [enableServerSideSorting]="rowModelType === 'infinite'"

        [suppressNoRowsOverlay]="true"
        [suppressDragLeaveHidesColumns]="true"
        [headerHeight]="35"
        [rowHeight]="35"
        [rowDragManaged]="true"
        [suppressRowDrag]="!config?.rowDraggable"
        [cacheBlockSize]="cacheBlockSize"

        [pagination]="usePagination"
        [paginationPageSize]="config?.pageSize"
        (paginationChanged)="onPaginationChange($event)"

        (gridReady)="onAgGridReady($event)"
        (gridSizeChanged)="gridSizeChangeDebouncer$.next($event)"
        (columnResized)="colResizeDebouncer$.next($event)"
        (modelUpdated)="onAgModelUpdate($event)"
        (rowDragEnd)="onRowDragEnd($event)"

        [rowSelection]="selectionMode"
        [suppressRowClickSelection]="selectionMode === 'multiple'"
        [isRowSelectable]="isRowSelectable"
        (selectionChanged)="onSelectionChange($event)"
        (rowSelected)="onRowSelected($event)"
        (rowClicked)="onRowClick($event)"
        (cellClicked)="onCellClick($event)"
        (columnMoved)="columnMoveDebouncer$.next($event)"

        [context]="context"
        [frameworkComponents]="cellRendererComponents">
    </ag-grid-angular>

    <section class="pagination" *ngIf="usePagination && paginationInfo?.pageCount > 1">
        <i class="material-icons" (click)="paginate('first')">first_page</i>
        <i class="material-icons" (click)="paginate('prev')">keyboard_arrow_left</i>

        <span class="pagination-info" *ngIf="paginationInfo">
            Side
            <input type="text" #pageInput
                [value]="paginationInfo.currentPage"
                (change)="paginationInputChange(pageInput.value)"
            />
            av {{paginationInfo.pageCount}}
        </span>

        <i class="material-icons" (click)="paginate('next')">keyboard_arrow_right</i>
        <i class="material-icons" (click)="paginate('last')">last_page</i>
    </section>
</section>
