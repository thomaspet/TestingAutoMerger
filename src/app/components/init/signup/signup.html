<article class="authentication-component">
    <p class="registration-step-info" *ngIf="!confirmationCode && !successMessage && !errorMessage">
        Vennligst registrer deg her for å prøve Uni Economy gratis i 30 dager.
    </p>

    <small class="validation info" *ngIf="confirmationCode && !successMessage && !errorMessage && !step2Successful">
        Selskapet ditt er klart for oppretting. Vennligst fyll ut ønsket brukernavn og passord for å komme i gang.
    </small>

    <small class="validation error" *ngIf="errorMessage">
        {{errorMessage}}
    </small>

    <small class="validation good" *ngIf="successMessage" [innerHTML]="successMessage"></small>

    <form #step1="ngForm" *ngIf="!confirmationCode && !successMessage" [formGroup]="step1Form" (ngSubmit)="submitStep1Form()">
        <label for="companyNameInput">Selskapsnavn</label>
        <input id="companyNameInput"
            type="text"
            placeholder="Selskapsnavn"
            autofocus
            formControlName="CompanyName"
        />

        <label for="displayNameInput">Ditt navn</label>
        <input id="displayNameInput"
            type="text"
            placeholder="Ditt navn"
            formControlName="DisplayName"
        />

        <label for="emailInput">E-post</label>
        <input id="emailInput"
            type="email"
            placeholder="E-post"
            formControlName="Email"
        />

        <label for="phoneInput">Telefonnummer</label>
        <input id="phoneInput"
            type="tel"
            placeholder="Telefonnummer"
            formControlName="PhoneNumber"
        />

        <small class="privacy-info">
            Når du registrerer deg her bekrefter du at du godtar lagring og bruk
            av dine personlige data. <!--  i henhold til vår <a href="">personvernpolicy</a> -->
        </small>

        <re-captcha formControlName="RecaptchaResponse"></re-captcha>

        <button
            type="submit"
            class="auth-button bad"
            [attr.aria-busy]="busy"
            [disabled]="busy || !step1.form.valid">
            START REGISTRERING
        </button>
    </form>

    <form #step2="ngForm" 
        *ngIf="confirmationCode && !step2Successful && !invalidConfirmationCode && !userExists" 
        [formGroup]="step2Form" 
        (ngSubmit)="submitStep2Form()"
    >
        <i class="material-icons username-tooltip" matTooltip="Brukernavn kan inneholde bokstaver, tall, bindestrek, understrek og punktum">help_outline</i>
        <label for="usernameInput">Brukernavn</label>
        <input id="usernameInput"
            type="text"
            autofocus
            placeholder="Brukernavn *"
            formControlName="UserName"
        />
        <small class="bad">{{step2Form?.get('UserName').errors?.usernameValidator}}</small>

        <label for="passwordInput">Passord</label>
        <input id="passwordInput"
            type="password"
            placeholder="Passord *"
            formControlName="Password"
        />

        <small class="bad">{{step2Form?.get('Password').errors?.passwordValidator}}</small>

        <label for="confirmPasswordInput">Bekreft passord</label>
        <input id="confirmPasswordInput"
            type="password"
            placeholder="Bekreft passord *"
            formControlName="ConfirmPassword"
        />
        <small class="bad">{{step2Form?.get('ConfirmPassword').errors?.passwordMatchValidator}}</small>

        <uni-password-guide *ngIf="step2Form?.controls"
            [passwordControl]="step2Form.controls.Password">
        </uni-password-guide>

        <button
            type="submit"
            class="auth-button bad"
            [attr.aria-busy]="busy"
            [disabled]="busy">
            FULLFØR REGISTRERING
        </button>
    </form>

    <ng-container *ngIf="step2Successful && !errorMessage">
        <small class="validation good">
            Registrering fullført!<br>Prøveperioden på 30 dager er nå aktiv.
        </small>
        <button class="auth-button c2a" [routerLink]="['/init/login']">
            Gå til innlogging
        </button>
    </ng-container>

    <section class="links" *ngIf="!step2Successful && !invalidConfirmationCode && !step1Successful">
        <a [routerLink]="['/init/login']">Tilbake til innlogging</a>
    </section>
    <section class="links" *ngIf="invalidConfirmationCode">
        <a [routerLink]="['/init/sign-up']" (click)="invalidConfirmationCode = false">Tilbake til registrering</a>
    </section>
</article>
