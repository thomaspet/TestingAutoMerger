<uni-toolbar
    [config]="toolbarConfig"
    [saveactions]="saveActions">
</uni-toolbar>

<section class="application">
    <uni-tabs
        [tabs]="filters"
        [labelProperty]="'label'"
        [(activeIndex)]="activeFilterIndex"
        (tabClick)="onFilterClick($event)">
    </uni-tabs>

    <section class="progress-container">
        <mat-progress-bar
            *ngIf="loading$ | async"
            class="uni-progress-bar"
            mode="indeterminate">
        </mat-progress-bar>
    </section>

    <section class="bill-container">
        <!-- List -->
        <section class="uni-container bill-list">

            <uni-autocomplete-input
                *ngIf="activeFilterIndex > 1 && activeFilterIndex < 5"
                class="assignee-filter"
                [field]="assigneeFilterField"
                [model]="searchParams$"
                (changeEvent)="onFormFilterChange($event)">
            </uni-autocomplete-input>


            <uni-table
                [resource]="listOfInvoices"
                [config]="tableConfig"
                (rowSelected)="onRowSelected($event)"
                (rowDeleted)="onRowDeleted($event.rowModel)"
                (pageChange)="onPageChange($event)"
                (rowSelectionChanged)="onRowSelectionChanged()">
            </uni-table>
            <span title="Oppdater" class="refreshbutton" (click)="onRefreshClicked()" ><i class="material-icons vertical-middle">refresh</i></span>

            <div class="right total" *ngIf="this.currentFilter.name === 'Inbox'">
                {{currentFilter.label}} ({{currentFilter.count}} stk.)
            </div>
            <div class="right total" *ngIf="this.currentFilter.name !== 'Inbox'">
                Sum {{currentFilter.label}} ({{currentFilter.count}} stk.) : {{totals.grandTotal | unicurrency}}
            </div>
        </section>

        <!-- Detail -->
        <section class="uni-container bill-preview" *ngIf="previewVisible">
            <section *ngIf="fileID" class="accounting-preview-links">
                <a (click)="documentSelected(true)">Bruk på leverandørfaktura</a>
                <a (click)="documentSelected(false)">Bruk i bilagsføring</a>
            </section>

            <uni-image
                [splitFileDialogAllowed]="true"
                [rotateAllowed]="true"
                [uploadWithoutEntity]="true"
                [readonly]="true"
                [fileIDs]="fileID"
                (fileListReady)="onFileListReady($event)"
                (fileSplitCompleted)="onFileSplitCompleted()">
            </uni-image>
        </section>
    </section>
</section>
