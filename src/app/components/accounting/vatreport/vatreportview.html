<header class="poster">
    <article class="poster_toolbar">
        <section>
            <h1>Merverdioppgave, periode {{currentVatReport?.TerminPeriod?.No}}</h1>
            <p>
               {{currentVatReport?.TerminPeriod | periodDateFormat}}
            </p>
        </section>
        <nav class="poster_toolbar_tools">
            <a (click)="onBackPeriod()" class="previous">Forrige</a>
            <a (click)="onForwardPeriod()" class="next">Neste</a>
        </nav>
    </article>

    <section class="poster_overview vatreportheader">

        <div class="poster_widgets">
            <dl class="poster_widget">
                <dt>Org.nr</dt>
                <dd>{{companySettings?.OrganizationNumber}}</dd>

                <dt>Navn</dt>
                <dd>{{companySettings?.CompanyName}}</dd>

                <dt>Kontonr. for tilbakebetaling</dt>
                <dd>{{companySettings?.CompanyBankAccount?.AccountNumber}}</dd>
            </dl>

            <article class="poster_widget tablewidget">
                <table>
                    <tr>
                        <th></th><th class="datacolumn">Grunnlag</th><th class="datacolumn">Avgift</th>
                    </tr>
                    <tr *ngFor="let summaryItem of vatReportSummary">
                        <td>{{summaryItem.VatCodeGroupName}}</td>
                        <td class="currency">
                            <a href="/accounting/transquery/details;vatCodes={{vatReportSummaryToVatCodes(summaryItem)}};vatFromDate={{currentVatReport?.TerminPeriod.FromDate}};vatToDate={{currentVatReport?.TerminPeriod.ToDate}}">
                                {{summaryItem.SumTaxBasisAmount * -1 | unicurrency:2}}
                            </a>
                        </td>
                        <td class="currency">
                            <a href="/accounting/transquery/details;vatCodes={{vatReportSummaryToVatCodes(summaryItem)}};vatFromDate={{currentVatReport?.TerminPeriod.FromDate}};vatToDate={{currentVatReport?.TerminPeriod.ToDate}}">
                                {{summaryItem.SumVatAmount * -1 | unicurrency:2}}
                            </a>
                        </td>
                    </tr>
                </table>
            </article>

            <article class="poster_widget">
                <ul class="statuslist">
                    <li [className]="isControlledWithoutWarnings() ? 'success' : 'warn'">
                        {{ isControlledWithoutWarnings() ? 'Automatisk kontroll ok' : 'Automatisk kontroll har advarsler' }}
                    </li>
                    <li [className]="isExecuted ? 'success' : ''">
                        {{ isExecuted ? 'Kjørt ok' : 'Ikke kjørt' }}
                    </li>
                    <li [className]="isSendt ? 'success' : ''">
                        {{ isSendt ? 'Sendt inn ok' : 'Ikke sendt inn' }}
                    </li>
                </ul>
            </article>

        </div>


    </section>
    <div class="horizontal_nav">
        <ul>
            <li>
                <a (click)="showView = 'control'" [class.router-link-active]="showView == 'control'">Kontroll</a>
            </li>
            <li>
                <a (click)="showView = ''" [class.router-link-active]="showView == ''">Oppgave</a>
            </li>
            <li *ngIf="currentVatReport?.PaymentID">
                <a (click)="showView = 'receipt'" [class.router-link-active]="showView == 'receipt'">Altinn, kvittering/tilbakemelding</a>
            </li>
        </ul>
    </div>
</header>



<section class="application" [attr.aria-busy]="isBusy">

    <vatreport-checklist-view
            *ngIf="showView == 'control'"
            [attr.aria-busy]="!reportMessages"
            [vatReportMessages]="reportMessages"
    ></vatreport-checklist-view>
    <vat-summary-per-post
            *ngIf="showView == ''"
            [attr.aria-busy]="!reportSummaryPerPost"
            [reportSummaryPerPost]="reportSummaryPerPost"
            [period]="currentVatReport?.TerminPeriod"
            [vatTypes]="vatTypes"
    ></vat-summary-per-post>
    <vatreport-receipt-view
            *ngIf="showView == 'receipt'"
            [vatReport]="currentVatReport"
    ></vatreport-receipt-view>

    <footer class="full-footer">
        <section class="application">
            <uni-save [actions]="saveActions"></uni-save>
        </section>
    </footer>

    <div class="comment commentToSend">
        <label>Kommenter til Altinn</label>
        <textarea
                [formControl]="externalComment"
                [ngModel]="currentVatReport.Comment"
                [disabled]="currentVatReport?.ID == 0"></textarea>
    </div>

    <div class="comment internalComment">
        <label>Intern kommentar</label>
        <textarea
                [formControl]="internalComment"
                [ngModel]="currentVatReport.InternalComment"
                [disabled]="currentVatReport?.ID == 0"></textarea>
    </div>
</section>
