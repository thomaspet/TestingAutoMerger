<section [ngClass]="{'journalentry-input-area-full': !journalEntrySettings.AttachmentsVisible, 'journalentry-input-area': journalEntrySettings.AttachmentsVisible}">
    <div class="journalentry-input-components">
        <journal-entry-professional (dataLoaded)="onDataLoaded($event)"
                                    (showImageChanged)="onShowImageChanged($event)"
                                    (showImageForJournalEntry)="onShowImageForJournalEntry($event)"
                                    (columnVisibilityChange)="onColumnVisibilityChange($event)"
                                    (rowSelected)="onRowSelected($event)"
                                    [runAsSubComponent]="runAsSubComponent"
                                    [disabled]="disabled"
                                    [mode]="mode"
                                    [journalEntryID]="journalEntryID"
                                    [doShowImage]="journalEntrySettings.AttachmentsVisible"
                                    [defaultVisibleColumns]="journalEntrySettings.DefaultVisibleFields"
                                    [financialYears]="financialYears"
                                    [currentFinancialYear]="currentFinancialYear"
                                    [vatDeductions]="vatDeductions"
                                    [selectedNumberSeriesTaskID]="selectedNumberSeriesTaskID">
        </journal-entry-professional>

        <uni-summary [configs]="summary" *ngIf="itemsSummaryData" [attr.aria-busy]="busy"></uni-summary>

        <section class="account_summary_container">
            <table class="account_summary_info" *ngIf="itemAccountInfoData && currentFinancialYear">
                <tr>
                    <th class="first_col"></th>
                    <th class="other_cols">Debet</th>
                    <th class="other_cols">Kredit</th>
                </tr>
                <tr>
                    <td>Kontonavn</td>
                    <td>{{ itemAccountInfoData.debitAccount ? itemAccountInfoData.debitAccount.AccountName : '(Ikke valgt)' }}</td>
                    <td>{{ itemAccountInfoData.creditAccount? itemAccountInfoData.creditAccount.AccountName : '(Ikke valgt)' }}</td>
                </tr>
                <tr *ngIf="itemAccountInfoData.deductionPercent && ((itemAccountInfoData.debitAccount && itemAccountInfoData.debitAccount.UseDeductivePercent) || (itemAccountInfoData.creditAccount && itemAccountInfoData.creditAccount.UseDeductivePercent))">
                    <td>Fradragsprosent MVA</td>
                    <td>{{ itemAccountInfoData.debitAccount && itemAccountInfoData.debitAccount.UseDeductivePercent ? itemAccountInfoData.deductionPercent + '%' : '' }}</td>
                    <td>{{ itemAccountInfoData.creditAccount && itemAccountInfoData.creditAccount.UseDeductivePercent ? itemAccountInfoData.deductionPercent + '%' : '' }}</td>
                </tr>
                <tr>
                    <td>Saldo ({{currentFinancialYear.Year}})</td>
                    <td>{{ getFormattedNumber(itemAccountInfoData.debitOriginalBalance) }}</td>
                    <td>{{ getFormattedNumber(itemAccountInfoData.creditOriginalBalance) }}</td>
                </tr>
                <tr>
                    <td>Nettobeløp</td>
                    <td>{{ getFormattedNumber(itemAccountInfoData.debitNetChangeCurrentLine) }}</td>
                    <td>{{ getFormattedNumber(itemAccountInfoData.creditNetChangeCurrentLine) }}</td>
                </tr>
                <tr>
                    <td>Inng. mva</td>
                    <td>{{ getFormattedNumber(itemAccountInfoData.debitIncomingVatCurrentLine) }}</td>
                    <td>{{ getFormattedNumber(itemAccountInfoData.creditIncomingVatCurrentLine) }}</td>
                </tr>
                <tr>
                    <td>Utg. mva</td>
                    <td>{{ getFormattedNumber(itemAccountInfoData.debitOutgoingVatCurrentLine) }}</td>
                    <td>{{ getFormattedNumber(itemAccountInfoData.creditOutgoingVatCurrentLine) }}</td>
                </tr>
                <tr>
                    <td>Ny saldo</td>
                    <td>{{ getFormattedNumber(itemAccountInfoData.debitNewBalance) }}</td>
                    <td>{{ getFormattedNumber(itemAccountInfoData.creditNewBalance) }}</td>
                </tr>
            </table>
        </section>
         <section class="openposts_container">
             <p *ngIf="openPostRetrievingDataInProgress">Henter åpne poster...</p>
             <p *ngIf="openPostsForSelectedRow && openPostsForSelectedRow.length === 0">
                 Ingen åpne poster funnet for valgt rad
             </p>
             <div class="openposts_wrapper"
                *ngIf="openPostsForSelectedRow && openPostsForSelectedRow.length > 0">
                <uni-table
                    [resource]="openPostsForSelectedRow"
                    [config]="openPostTableConfig"
                    (rowSelectionChanged)="openPostSelected($event)">
                </uni-table>
             </div>
        </section>

        <div class="validation_messages_container" *ngIf="validationResult && validationResult.Messages.length > 0">
            <strong *ngFor="let message of validationResult.Messages"
                class="journalEntry_validation validation {{getValidationLevelCss(message.Level)}}"
                    [ngClass]="{
                    simplemode: journalEntryMode === 'SIMPLE',
                    promode: journalEntryMode != 'SIMPLE',
                    runassubcomponent: runAsSubComponent
                }">
                {{message.Message}}
            </strong>
        </div>
    </div>
</section>

<section *ngIf="journalEntrySettings && journalEntrySettings.AttachmentsVisible && this.mode !== 1" class="journalentry-image-area">
    <span>
        Vedlegg for bilagsnr {{showImagesForJournalEntryNo ? showImagesForJournalEntryNo : "(nytt bilag)"}}

        <uni-image [uploadWithoutEntity]="'true'" [fileIDs]="currentJournalEntryImages"
                    (fileListReady)="onFileListReady($event)"></uni-image>
    </span>
</section>

<uni-confirm-modal></uni-confirm-modal>
