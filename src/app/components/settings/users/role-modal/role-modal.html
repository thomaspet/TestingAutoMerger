<section role="dialog" class="uni-modal">
    <header>
        <h1>{{user?.DisplayName || user?.Email}}</h1>
    </header>

    <article>
        <section *ngIf="busy" class="modal-spinner">
            <mat-spinner class="c2a"></mat-spinner>
        </section>

        <mat-accordion multi="true">
            <mat-expansion-panel #panel
                *ngFor="let group of roleGroups; let idx = index"
                [expanded]="!group.product || group.productPurchased"
                [hideToggle]="true">

                <mat-expansion-panel-header [collapsedHeight]="'45px'" [expandedHeight]="'45px'" style="background: #f0f0f0;">
                    <mat-panel-title>{{group.label}}</mat-panel-title>

                    <i *ngIf="!group.product || group.productPurchased" class="material-icons panel-toggle">
                        {{panel.expanded ? 'expand_less' : 'expand_more'}}
                    </i>

                    <section *ngIf="group.product && !group.productPurchased" class="panel-right">
                        <button (click)="purchaseProduct(group)">
                            Kj√∏p produkt
                        </button>
                    </section>
                </mat-expansion-panel-header>

                <section>
                    <mat-selection-list>
                        <mat-list-option *ngFor="let role of group.roles"
                            [disabled]="group.product && !group.productPurchased"
                            [checkboxPosition]="'before'"
                            [selected]="role._checked"
                            (click)="onRoleClick(group, role)">
                            {{role.Label}}
                        </mat-list-option>
                    </mat-selection-list>
                </section>
            </mat-expansion-panel>
        </mat-accordion>
    </article>

    <footer class="center">
        <button class="c2a rounded" (click)="saveRoles()">Lagre endringer</button>
        <button (click)="onClose.emit(false)">Avbryt</button>
    </footer>
</section>