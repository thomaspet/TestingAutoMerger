<uni-toolbar [config]="toolbarconfig"></uni-toolbar>

<order-to-invoice-modal *ngIf="order"></order-to-invoice-modal>

<header class="order_poster" *ngIf="order">
     <!-- Widget poster -->
    <section class="poster_overview">
        <uni-widget-poster [model]="order">
            <section class="application">
            </section>
        </uni-widget-poster>
    </section>
</header>

<section class="order-details application">
    <uni-form *ngIf='order'
              [config]="config"
              [fields]="fields"
              [model]="order"
              (onChange)="change($event)"
              (onReady)="ready($event)">
    </uni-form>
    <address-modal question="Lagre på kundekort?"></address-modal>

    <order-item-list *ngIf="order && dropdownData" [order]="order" [departments]="dropdownData[0]" [projects]="dropdownData[1]" (itemsUpdated)="recalcItemSums($event)" (itemDeleted)="deleteItem($event)" (itemsLoaded)="recalcItemSums($event)"></order-item-list>
    <section class="order-items-summary-placeholder" *ngIf="!itemsSummaryData" aria-busy> </section>

    <dl class="summary" *ngIf="itemsSummaryData" [attr.aria-busy]="busy">
        <dt>Avgiftsfritt</dt>
        <dd>Kr. {{itemsSummaryData.SumNoVatBasis}}</dd>
        <dt>Avgiftsgrunnlag</dt>
        <dd>Kr. {{itemsSummaryData.SumVatBasis}}</dd>
        <dt>Sum rabatt</dt>
        <dd>Kr. {{itemsSummaryData.SumDiscount}}</dd>
        <dt>Nettosum</dt>
        <dd>Kr. {{itemsSummaryData.SumTotalExVat}}</dd>
        <dt>Mva</dt>
        <dd>Kr. {{itemsSummaryData.SumVat}}</dd>
        <dt>Øreavrunding</dt>
        <dd>Kr. {{itemsSummaryData.DecimalRounding}}</dd>
        <dt>Totalsum</dt>
        <dd>Kr. {{itemsSummaryData.SumTotalIncVat}}</dd>
    </dl>
</section>

<report-preview-modal></report-preview-modal>

<footer class="full-footer">
    <section class="application" *ngIf="actions">
        <uni-save [actions]="actions"></uni-save>
    </section>
</footer>